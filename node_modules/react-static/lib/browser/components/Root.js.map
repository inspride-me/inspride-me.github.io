{"version":3,"sources":["../../../src/browser/components/Root.js"],"names":["DefaultPath","render","DefaultRouter","children","rest","Root","props","staticInfo","process","env","REACT_STATIC_ENV","path","sharedData","sharedHashesByProp","templateIndex","routeInfoByPath","Object","keys","forEach","propKey","sharedDataByHash","disableScroller","autoScrollToTop","autoScrollToHash","scrollToTopDuration","scrollToHashDuration","scrollToHashOffset","scrollerProps","Wrapper","basepath","renderProps","renderedChildren","React","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Router as ReachRouter } from '@reach/router'\n\n//\nimport { routeInfoByPath, sharedDataByHash, registerTemplateForPath } from '../'\nimport { getBasePath } from '../utils'\nimport ErrorBoundary from './ErrorBoundary'\nimport HashScroller from './HashScroller'\nimport { withStaticInfo } from './StaticInfo'\n\n// If we're in SSR, set the ServerLocation\n// if (isSSR()) {\n//   routePath = getCurrentRoutePath()\n//   Wrapper = ({ children }) => (\n//     <ServerLocation url={routePath}>{children}</ServerLocation>\n//   )\n// }\n\nconst DefaultPath = ({ render }) => render\n\nconst DefaultRouter = ({ children, ...rest }) => (\n  <ReachRouter {...rest}>\n    <DefaultPath default render={children} />\n  </ReachRouter>\n)\n\nconst Root = withStaticInfo(\n  class Router extends React.Component {\n    static defaultProps = {\n      disableScroller: false, // TODO:v6 document this!\n      autoScrollToTop: true,\n      autoScrollToHash: true,\n      scrollToTopDuration: 0,\n      scrollToHashDuration: 800,\n      scrollToHashOffset: 0,\n    }\n    constructor(props) {\n      super()\n      const { staticInfo } = props\n      if (process.env.REACT_STATIC_ENV === 'production' && staticInfo) {\n        const {\n          path,\n          sharedData,\n          sharedHashesByProp,\n          templateIndex,\n        } = staticInfo\n\n        // Hydrate routeInfoByPath with the embedded routeInfo\n        routeInfoByPath[path] = staticInfo\n\n        // Hydrate sharedDataByHash with the embedded routeInfo\n        Object.keys(sharedHashesByProp).forEach(propKey => {\n          sharedDataByHash[sharedHashesByProp[propKey]] = sharedData[propKey]\n        })\n\n        // In SRR and production, synchronously register the templateIndex for the\n        // initial path\n        registerTemplateForPath(path, templateIndex)\n      }\n    }\n    render() {\n      const {\n        children,\n        disableScroller,\n        autoScrollToTop,\n        autoScrollToHash,\n        scrollToTopDuration,\n        scrollToHashDuration,\n        scrollToHashOffset,\n        staticInfo,\n        ...rest\n      } = this.props\n\n      const scrollerProps = {\n        autoScrollToTop,\n        autoScrollToHash,\n        scrollToTopDuration,\n        scrollToHashDuration,\n        scrollToHashOffset,\n      }\n\n      let Wrapper = ({ children }) => children\n\n      const basepath = getBasePath()\n\n      // Add the scroller if not disabled\n      if (!disableScroller) {\n        Wrapper = ({ children }) => (\n          <HashScroller {...scrollerProps}>{children}</HashScroller>\n        )\n      }\n\n      // TODO:v6 Document how to replace the root router (and apply basepath)\n      // I'm not sure why you would want to do this, but it's general\n      // inversion of control and I feel safer exposing it rather than\n      // making it non-configurable\n      const renderProps = {\n        basepath,\n        ...rest,\n      }\n\n      // Either use the child as a function, or our default router with children\n      const renderedChildren =\n        typeof children === 'function' ? (\n          children(renderProps)\n        ) : (\n          <DefaultRouter {...renderProps}>{children}</DefaultRouter>\n        )\n\n      return (\n        <ErrorBoundary>\n          <Wrapper>{renderedChildren}</Wrapper>\n        </ErrorBoundary>\n      )\n    }\n  }\n)\n\nexport default Root\n"],"file":"Root.js"}